<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
   <mapper namespace="eventMapper">
  
  <select id="selectList" parameterType="com.cnema.util.RowNum" resultType="EventDTO">
  		select * from
  		(select rownum r, N.* from
  		(select * from event
		<if test="kind == 'Title'">
			where Title like '%'||#{search}||'%'
		</if>
	
		<if test="kind == 'Contents'">
			where Contents like '%'||#{search}||'%'
		</if>
		order by num desc) N)
  		where r between #{startRow} and #{lastRow}
  	</select>
  	
  	<select id="totalCount" parameterType="com.cnema.util.RowNum" resultType="int">
  		select count(num) from event
  		<if test="kind == 'Title'">
  			where title like '%'||#{search}||'%'
  		</if>
  
  		<if test="kind == 'Contents'">
  			where contents like '%'||#{search}||'%'
  		</if>
  	</select>
  
    <insert id="insert" parameterType="com.cnema.board.BoardDTO">
  
  	insert into event
  	values(event_seq.nextval,#{title},#{writer},#{contents},#{fileName},#{oriName},#{s_date},#{e_date},#{type})
  </insert>
 
 <!--View보여줄때 사용  -->
  <select id="selectOne" parameterType="int" resultType="EventDTO">
  		select * from event where num=#{num}
  	</select>
  	
  	<!-- 테이블 고치면 사용함!  -->
  	<update id="hitUpdate" parameterType="int">
  		update event set hit=hit+1 where num=#{num}
  	</update>
  
 	 <delete id="delete" parameterType="int">
  		delete event where num=#{num}
  	</delete>
  	
  	<update id="update" parameterType="com.cnema.board.BoardDTO">
  		update event set
  		title=#{title}, contents=#{contents}, filename=#{fileName},oriname=#{oriName},s_date=#{s_date},e_date=#{e_date},type=#{type}
  		where num=#{num}
  	</update>
  
   </mapper>