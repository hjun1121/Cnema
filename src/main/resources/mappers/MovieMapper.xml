<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="movieMapper">

	<delete id="wishDelete" parameterType="java.util.Map">
		delete wish where movie_num=#{movie_num} and id=#{id}
	</delete>

	<insert id="wishInsert" parameterType="java.util.Map">
		insert into wish values(movie_seq.nextval, #{movie_num}, #{id})
	</insert>

	<update id="movieWishReturn" parameterType="int">
		update movie set wish=wish-1 where movie_num=#{movie_num}
	</update>
	
	<update id="movieWish" parameterType="int">
		update movie set wish=wish+1 where movie_num=#{movie_num}
	</update>

 	<select id="wishList" resultType="com.cnema.movie.WishDTO">
		select * from wish
	</select>

 	<select id="wishList1"  parameterType="String" resultType="com.cnema.movie.WishDTO">
		select * from wish	where id=#{id}
	</select>

  	<select id="selectOne" resultType="movieDTO" parameterType="int">
  		SELECT * FROM movie WHERE movie_num=#{movie_num}
  	</select>
  	
  	<select id="movieList" parameterType="java.util.Map" resultType="movieDTO">
  		select * from movie 
  		<choose>
  			<when test="kind == 'grade'">
  				order by grade desc
  			</when>
  			<when test="kind == 'open_date'">
  				order by open_date desc
  			</when>
  			<when test="kind == 'reserve_rate'">
  				order by reserve_rate desc
  			</when>
  		</choose>

  	</select>
 
  	<insert id="insert" parameterType="movieDTO">
  		insert into movie values(movie_seq.nextval, #{movie_name}, #{fileName}, #{oriName}, #{teaser_url}, 0, 0, #{open_date}, #{run_time}, 0, #{type}, #{contents}, #{age_limit}, #{actor})
  	</insert>

  	<!-- heeseong -->
  	<select id="movieInfo" resultType="movieDTO" >
  		select * from movie where movie_num=#{movie_num}
  	</select>
  	
  	<!-- heeseong -->
  	<select id="movieAList" resultType="movieDTO">
  		select * from movie order by movie_num desc
  	</select>
  	<!-- heeseong -->
  	<update id="movieRevision" parameterType="movieDTO">
  		update movie set movie_name=#{movie_name}, teaser_url=#{teaser_url},open_date=#{open_date},run_time=#{run_time},type=#{type},contents=#{contents},age_limit=#{age_limit},actor=#{actor} where movie_num=#{movie_num}
  	</update>
</mapper>
